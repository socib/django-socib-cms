{% extends "news/base.html" %}
{% load i18n %}
{% load staticfiles %}
{% load mptt_tags %}
{% load thumbnail %}
{% load localeurl_tags %}

{% block title_head %}{{ block.super }}: {{ news.title }}{% endblock %}

{% block title %}
{{ news.title }}
{% endblock %}

{% block extra-heading %}
<div class="news-info">
  {{ news.publish_date|date:"SHORT_DATE_FORMAT" }}
</div>
{% endblock %}

{% block mainclass %}container {{ page.css_class }}{% endblock mainclass%}

{% block breadscrumbs %}
<ol class="breadcrumb">
  {% for node in page.get_ancestors %}
  <li class="{{ node.css_class }}">
    {% if node.container %}
    <a><span>{{ node.title }}</span></a>
    {% else %}
    <a href="{{ node.url|chlocale:LANGUAGE_CODE  }}"><span>{{ node.title }}</span></a>
    {% endif %}
  </li>
  {% endfor %}
  <li ><a href="{% url 'news_category_detail' news.category.slug %}">{{ page.title }}</a>
  </li>
  <li class="active">{{ news.title|truncatechars:70 }}
  </li>
</ol>
{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-9 col-sm-8">
    {% if news.album %}
    <div class="news-album">
      <div id="carousel-example-generic" class="carousel slide" data-ride="carousel">
        <!-- Indicators -->
        <ol class="carousel-indicators">
        {% for image in news.album.files.all %}
          {% if image.height > 0 %}
            <li data-target="#carousel-example-generic" data-slide-to="{{ forloop.counter0 }}" {% if forloop.counter0 == 0 %} class="active"{% endif %}></li>
          {% endif %}
        {% endfor %}
        </ol>
        <!-- Wrapper for slides -->
        <div class="carousel-inner">
          {% for image in news.album.files.all %}
            {% if image.height > 0 %}
              <div class="item {% if forloop.counter0 == 0 %}active{% endif %}">
                <img src="{% thumbnail image 800x500 upscale crop subject_location=image.subject_location  %}" class="img-responsive">
              </div>
            {% endif %}
          {% endfor %}
        </div>
        <!-- Controls -->
        <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
          <span class="glyphicon glyphicon-chevron-left"></span>
        </a>
        <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
          <span class="glyphicon glyphicon-chevron-right"></span>
        </a>
      </div>
    </div>
    {% endif %}
    <div class="news-content">
      {{ news.content|safe }}
    </div>
  </div>
  <div class="col-md-3 col-sm-4">
    {% if news.picture %}
      <img src="{% thumbnail news.picture 250x0 crop %}" class="img-responsive">
    {% endif %}
    <h3>{% trans "Latests news" %}</h3>
    <div class="list-group">
    {% for item in news.category.news_set.latest10 %}
        {% if item != news %}
        <a class="list-group-item" href="{{ item.get_absolute_url }}">{{ item.title|truncatechars:60 }}</a>
        {% endif %}
    {% endfor %}
    </div>
  </div>
</div>
{% endblock %}

{% block page_js %}
<script type="text/javascript">
  $(function() {
    $(".navbar li a[href='{% url 'news_category_detail' news.category.slug %}']").parent().addClass('active');
    // Menu active from submenu:
    $('li.active').each(function(){
      var parent = $(this).parent().parent();
      if (parent.get(0).tagName == 'LI' && !parent.hasClass('change-lang')){
        parent.addClass('active');
      }
    });
  });
</script>
{% endblock page_js %}

